<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Data Apply — dapply • collapse</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Data Apply — dapply" />
<meta property="og:description" content="dapply efficiently applies functions to columns or rows of matrices and data frame's and (default) returns an object of the same type and with the same attributes, or converts to the other type. A simple parallelism is also available." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">collapse</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../blog/index.html">Blog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://twitter.com/collapse">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SebKrantz/collapse">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Data Apply</h1>
    
    <div class="hidden name"><code>dapply.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>dapply</code> efficiently applies functions to columns or rows of matrices and data frame's and (default) returns an object of the same type and with the same attributes, or converts to the other type. A simple parallelism is also available.</p>
    </div>

    <pre class="usage"><span class='fu'>dapply</span>(<span class='no'>X</span>, <span class='no'>FUN</span>, <span class='no'>...</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>mc.cores</span> <span class='kw'>=</span> <span class='fl'>1L</span>,
       <span class='kw'>return</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"same"</span>,<span class='st'>"matrix"</span>,<span class='st'>"data.frame"</span>), <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>a matrix or data frame.</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>a function, can be scalar- or vector-valued.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments to <code>FUN</code>.</p></td>
    </tr>
    <tr>
      <th>MARGIN</th>
      <td><p>integer. The margin which <code>FUN</code> will be applied over. Default <code>2</code> indicates columns while <code>1</code> indicates rows. See also Details.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>logical. <code>TRUE</code> implements simple parallel execution by internally calling <code><a href='https://rdrr.io/r/parallel/mcdummies.html'>parallel::mclapply</a></code> instead of <code><a href='https://rdrr.io/r/base/lapply.html'>base::lapply</a></code>.</p></td>
    </tr>
    <tr>
      <th>mc.cores</th>
      <td><p>integer. Argument to <code><a href='https://rdrr.io/r/parallel/mcdummies.html'>parallel::mclapply</a></code> indicating the number of cores to use for parallel execution. Can use <code><a href='https://rdrr.io/r/parallel/detectCores.html'>parallel::detectCores()</a></code> to select all available cores. See also <code><a href='https://rdrr.io/r/parallel/mcdummies.html'>?parallel::mclapply</a></code>.</p></td>
    </tr>
    <tr>
      <th>return</th>
      <td><p>an integer or string indicating the type of object to return. The default <code>1 - "same"</code> returns the same object type (i.e. passing a matrix returns a matrix and passing a data frame returns a data frame). <code>2 - "matrix"</code> always returns the output as matrix and <code>3 - "data.frame"</code> always returns a data frame.</p></td>
    </tr>
    <tr>
      <th>drop</th>
      <td><p>logical. If the result has only one row or one column, <code>drop = TRUE</code> will drop dimensions and return a (named) atomic vector.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>dapply</code> is an efficient command to apply functions to rows or columns of data without loosing information (attributes) about the data or changing the classes or format of the data. It is principally an efficient wrapper around <code><a href='https://rdrr.io/r/base/lapply.html'>base::lapply</a></code> and works as follows:</p>
<ul>
<li><p>Save the attributes of <code>X</code>.</p></li>
<li><p>If <code>MARGIN = 2</code> (columns), convert matrices to plain lists of columns using <code><a href='quick-conversion.html'>mctl</a></code> and remove all attributes from data frames.</p></li>
<li><p>If <code>MARGIN = 1</code> (rows), convert matrices to plain lists of rows using <code><a href='quick-conversion.html'>mrtl</a></code>. For data frames remove all attributes, efficiently convert to matrix using <code><a href='https://rdrr.io/r/base/do.call.html'>do.call(rbind, X)</a></code> and also convert to list of rows using <code><a href='quick-conversion.html'>mrtl</a></code>.</p></li>
<li><p>Call <code><a href='https://rdrr.io/r/base/lapply.html'>base::lapply</a></code> or <code><a href='https://rdrr.io/r/parallel/mcdummies.html'>parallel::mclapply</a></code> on these plain lists (which is faster than calling <code>lapply</code> on an object with attributes).</p></li>
<li><p>depending on the requested output type, use <code><a href='https://rdrr.io/r/base/matrix.html'>base::matrix</a></code>, <code><a href='https://rdrr.io/r/base/unlist.html'>base::unlist</a></code> or <code><a href='https://rdrr.io/r/base/do.call.html'>do.call(cbind, ...)</a></code> to convert the result back to a matrix or list of columns.</p></li>
<li><p>modify the relevant attributes accordingly and efficiently attach to the object again (no further checks). <!-- % , non essential attributes are kept and added at the end of the attribute list --></p></li>
</ul>

<p>This performance gain from working with plain lists makes <code>dapply</code> not much slower than calling <code>lapply</code> itself on a data frame. Because of the conversions involved, row-operations require some memory, but are still faster than <code><a href='https://rdrr.io/r/base/apply.html'>base::apply</a></code>.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>X</code> where <code>FUN</code> was applied to every row or column.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BY.html'>BY</a></code>, <code><a href='collap.html'>collap</a></code>, <a href='fast-statistical-functions.html'>Fast Statistical Functions</a>, <a href='data-transformations.html'>Data Transformations</a>, <a href='collapse-documentation.html'>Collapse Overview</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>log</span>)                      <span class='co'># Take natural log of each variable</span>
<span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>log</span>, <span class='kw'>return</span> <span class='kw'>=</span> <span class='st'>"matrix"</span>)   <span class='co'># Return as matrix</span>
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span>(<span class='no'>mtcars</span>)
<span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>log</span>)                           <span class='co'># Same thing</span>
<span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>log</span>, <span class='kw'>return</span> <span class='kw'>=</span> <span class='st'>"data.frame"</span>)    <span class='co'># Return data frame from matrix</span>
<span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>sum</span>); <span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>sum</span>)      <span class='co'># Computing sum of each column, return as vector</span>
<span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>sum</span>, <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)        <span class='co'># This returns a data.frame of 1 row</span>
<span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>sum</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)          <span class='co'># Compute row-sum of each column, return as vector</span>
<span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>sum</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)               <span class='co'># Same thing for matrices, faster than apply(m, 1, sum)</span>
<span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>sum</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>drop</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>) <span class='co'># Gives matrix with one column</span>
<span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>quantile</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)          <span class='co'># Compute row-quantiles</span>
<span class='fu'>dapply</span>(<span class='no'>m</span>, <span class='no'>quantile</span>)                      <span class='co'># Column-quantiles</span>
<span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>quantile</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)     <span class='co'># Same for data frames, output is also a data.frame</span>
<span class='fu'>dapply</span>(<span class='no'>mtcars</span>, <span class='no'>quantile</span>)

<span class='co'># Let's now take a more complex classed object, like a dplyr grouped tibble</span>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>dplyr</span>)
<span class='no'>gmtcars</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span>(<span class='no'>mtcars</span>,<span class='no'>cyl</span>,<span class='no'>vs</span>,<span class='no'>am</span>)
<span class='fu'>dapply</span>(<span class='no'>gmtcars</span>, <span class='no'>log</span>)                     <span class='co'># Still gives a grouped tibble back</span>
<span class='fu'>dapply</span>(<span class='no'>gmtcars</span>, <span class='no'>log</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='fu'>dapply</span>(<span class='no'>gmtcars</span>, <span class='no'>quantile</span>, <span class='kw'>MARGIN</span> <span class='kw'>=</span> <span class='fl'>1</span>)    <span class='co'># Also works for quantiles</span>
<span class='fu'>dapply</span>(<span class='no'>gmtcars</span>, <span class='no'>log</span>, <span class='kw'>return</span> <span class='kw'>=</span> <span class='st'>"matrix"</span>)  <span class='co'># Output as matrix</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sebastian Krantz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


